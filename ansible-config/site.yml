#!/usr/bin/env ansible-playbook
# ====================================================================
# PLAYBOOK SITE.YML : ORCHESTRATION COMPLÃˆTE
# ====================================================================
---
# ====================================================================
# PLAYBOOK 1 : INITIALISATION DES SERVEURS
# ====================================================================
- name: "STEP 1 : Initialisation des serveurs"
  import_playbook: 01-init-servers.yml
  tags:
    - init
    - servers

# ====================================================================
# PLAYBOOK 2 : DÃ‰PLOIEMENT ADMINER (Web Servers)
# ====================================================================
- name: "STEP 2 : DÃ©ploiement Adminer"
  import_playbook: 02-deploy-adminer.yml
  tags:
    - web
    - adminer
    - apache
    - php

# ====================================================================
# PLAYBOOK 3 : DÃ‰PLOIEMENT DATABASE (DB Servers)
# ====================================================================
- name: "STEP 3 : DÃ©ploiement Database (MySQL)"
  import_playbook: 03-deploy-database.yml
  tags:
    - database
    - mysql
    - db

# ====================================================================
# PLAYBOOK FINAL : RÃ‰SUMÃ‰
# ====================================================================
- name: "FINAL : RÃ©sumÃ© et vÃ©rifications"
  hosts: targets
  gather_facts: yes
  tasks:
    - name: "[SUMMARY] Afficher le rÃ©sumÃ© d'exÃ©cution"
      debug:
        msg: |
          
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘                                                            â•‘
          â•‘             âœ“ DÃ‰PLOIEMENT COMPLET TERMINÃ‰ !              â•‘
          â•‘                                                            â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ğŸ“Š INFRASTRUCTURE ANSIBLE
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          Serveurs configurÃ©s :
            â€¢ {{ inventory_hostname }}
          
          OS : {{ ansible_distribution }} {{ ansible_distribution_version }}
          Kernel : {{ ansible_kernel }}
          
          
          ğŸŒ ACCÃˆS AUX SERVICES
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          Web Servers :
            âœ“ http://localhost:8080/adminer/adminer.php  <-- PORT CORRIGÃ‰
          
          Database Server :
            âœ“ MySQL 8.0 sur db:3306
            âœ“ Utilisateur : adminer_user
            âœ“ Bases : testdb, adminer_db
          
          
          ğŸ” PROCHAINES Ã‰TAPES
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          1. VÃ©rifier la connectivitÃ© depuis Adminer.
          2. AccÃ©der Ã  Adminer sur votre navigateur :
             â†’ http://localhost:8080/adminer/adminer.php
          
          
          âœ… CONFIGURATION COMPLÃˆTE !
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      tags:
        - always